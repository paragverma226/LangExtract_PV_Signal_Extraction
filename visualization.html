<style>
.lx-highlight { position: relative; border-radius:3px; padding:1px 2px;}
.lx-highlight .lx-tooltip {
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
  background: #333;
  color: #fff;
  text-align: left;
  border-radius: 4px;
  padding: 6px 8px;
  position: absolute;
  z-index: 1000;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  max-width: 240px;
  white-space: normal;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.lx-highlight:hover .lx-tooltip { visibility: visible; opacity:1; }
.lx-animated-wrapper { max-width: 100%; font-family: Arial, sans-serif; }
.lx-controls {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 8px;
  padding: 12px; margin-bottom: 16px;
}
.lx-button-row {
  display: flex; justify-content: center; gap: 8px; margin-bottom: 12px;
}
.lx-control-btn {
  background: #4285f4; color: white; border: none; border-radius: 4px;
  padding: 8px 16px; cursor: pointer; font-size: 13px; font-weight: 500;
  transition: background-color 0.2s;
}
.lx-control-btn:hover { background: #3367d6; }
.lx-progress-container {
  margin-bottom: 8px;
}
.lx-progress-slider {
  width: 100%; margin: 0; appearance: none; height: 6px;
  background: #ddd; border-radius: 3px; outline: none;
}
.lx-progress-slider::-webkit-slider-thumb {
  appearance: none; width: 18px; height: 18px; background: #4285f4;
  border-radius: 50%; cursor: pointer;
}
.lx-progress-slider::-moz-range-thumb {
  width: 18px; height: 18px; background: #4285f4; border-radius: 50%;
  cursor: pointer; border: none;
}
.lx-status-text {
  text-align: center; font-size: 12px; color: #666; margin-top: 4px;
}
.lx-text-window {
  font-family: monospace; white-space: pre-wrap; border: 1px solid #90caf9;
  padding: 12px; max-height: 260px; overflow-y: auto; margin-bottom: 12px;
  line-height: 1.6;
}
.lx-attributes-panel {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 6px;
  padding: 8px 10px; margin-top: 8px; font-size: 13px;
}
.lx-current-highlight {
  border-bottom: 4px solid #ff4444;
  font-weight: bold;
  animation: lx-pulse 1s ease-in-out;
}
@keyframes lx-pulse {
  0% { text-decoration-color: #ff4444; }
  50% { text-decoration-color: #ff0000; }
  100% { text-decoration-color: #ff4444; }
}
.lx-legend {
  font-size: 12px; margin-bottom: 8px;
  padding-bottom: 8px; border-bottom: 1px solid #e0e0e0;
}
.lx-label {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 3px;
  margin-right: 4px;
  color: #000;
}
.lx-attr-key {
  font-weight: 600;
  color: #1565c0;
  letter-spacing: 0.3px;
}
.lx-attr-value {
  font-weight: 400;
  opacity: 0.85;
  letter-spacing: 0.2px;
}

/* Add optimizations with larger fonts and better readability for GIFs */
.lx-gif-optimized .lx-text-window { font-size: 16px; line-height: 1.8; }
.lx-gif-optimized .lx-attributes-panel { font-size: 15px; }
.lx-gif-optimized .lx-current-highlight { text-decoration-thickness: 4px; }
</style>
    <div class="lx-animated-wrapper lx-gif-optimized">
      <div class="lx-attributes-panel">
        <div class="lx-legend">Highlights Legend: <span class="lx-label" style="background-color:#D2E3FC;">adverse_event</span> <span class="lx-label" style="background-color:#C8E6C9;">concomitant_medication</span> <span class="lx-label" style="background-color:#FEF0C3;">outcome</span> <span class="lx-label" style="background-color:#F9DEDC;">patient_info</span> <span class="lx-label" style="background-color:#FFDDBE;">report_source</span> <span class="lx-label" style="background-color:#EADDFF;">seriousness</span> <span class="lx-label" style="background-color:#C4E9E4;">suspected_drug</span></div>
        <div id="attributesContainer"></div>
      </div>
      <div class="lx-text-window" id="textWindow">
        Case ID: AE-2025-001 
Patient Information: <span class="lx-highlight lx-current-highlight" data-idx="0" style="background-color:#F9DEDC;">54-year-old female</span> 
Suspected Drug: <span class="lx-highlight" data-idx="1" style="background-color:#C4E9E4;">DrugX 50mg daily</span> for hypertension 
Concomitant Medications: <span class="lx-highlight" data-idx="2" style="background-color:#C8E6C9;">Metformin</span> for diabetes, <span class="lx-highlight" data-idx="3" style="background-color:#C8E6C9;">Aspirin 75mg daily</span> 
Adverse Events: <span class="lx-highlight" data-idx="4" style="background-color:#D2E3FC;">Severe headache</span>, <span class="lx-highlight" data-idx="5" style="background-color:#D2E3FC;">dizziness</span>, <span class="lx-highlight" data-idx="6" style="background-color:#D2E3FC;">nausea</span> 
Seriousness Criteria: <span class="lx-highlight" data-idx="7" style="background-color:#EADDFF;">Hospitalization</span> 
Outcome: <span class="lx-highlight" data-idx="8" style="background-color:#FEF0C3;">Recovered after discontinuation of DrugX</span> 
Reporter: <span class="lx-highlight" data-idx="9" style="background-color:#FFDDBE;">Dr. John Smith</span>, Cardiology Department, City Hospital 
Date Reported: 15-Jan-2025 
Narrative: 
The patient reported experiencing severe headache and dizziness within two 
days of starting DrugX 50mg daily. Symptoms persisted and worsened, leading 
to hospitalization on 14-Jan-2025. Concomitant medications included 
Metformin for diabetes and Aspirin 75mg daily for cardiac protection. DrugX 
was discontinued during hospital stay, after which the patient recovered fully. 
The case was reported by Dr. John Smith on 15-Jan-2025.
      </div>
      <div class="lx-controls">
        <div class="lx-button-row">
          <button class="lx-control-btn" onclick="playPause()">▶️ Play</button>
          <button class="lx-control-btn" onclick="prevExtraction()">⏮ Previous</button>
          <button class="lx-control-btn" onclick="nextExtraction()">⏭ Next</button>
        </div>
        <div class="lx-progress-container">
          <input type="range" id="progressSlider" class="lx-progress-slider"
                 min="0" max="9" value="0"
                 onchange="jumpToExtraction(this.value)">
        </div>
        <div class="lx-status-text">
          Entity <span id="entityInfo">1/10</span> |
          Pos <span id="posInfo">[43-61]</span>
        </div>
      </div>
    </div>

    <script>
      (function() {
        const extractions = [{"index": 0, "class": "patient_info", "text": "54-year-old female", "color": "#F9DEDC", "startPos": 43, "endPos": 61, "beforeText": "Case ID: AE-2025-001 \nPatient Information: ", "extractionText": "54-year-old female", "afterText": " \nSuspected Drug: DrugX 50mg daily for hypertension \nConcomitant Medications: Metformin for diabetes, Aspirin 75mg daily \nAdverse Events: Severe heada", "attributesHtml": "<div><strong>class:</strong> patient_info</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">age</span>: <span class=\"lx-attr-value\">54</span>, <span class=\"lx-attr-key\">sex</span>: <span class=\"lx-attr-value\">female</span>}</div>"}, {"index": 1, "class": "suspected_drug", "text": "DrugX 50mg daily", "color": "#C4E9E4", "startPos": 79, "endPos": 95, "beforeText": "Case ID: AE-2025-001 \nPatient Information: 54-year-old female \nSuspected Drug: ", "extractionText": "DrugX 50mg daily", "afterText": " for hypertension \nConcomitant Medications: Metformin for diabetes, Aspirin 75mg daily \nAdverse Events: Severe headache, dizziness, nausea \nSeriousnes", "attributesHtml": "<div><strong>class:</strong> suspected_drug</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">dose</span>: <span class=\"lx-attr-value\">50mg</span>, <span class=\"lx-attr-key\">frequency</span>: <span class=\"lx-attr-value\">daily</span>}</div>"}, {"index": 2, "class": "concomitant_medication", "text": "Metformin", "color": "#C8E6C9", "startPos": 139, "endPos": 148, "beforeText": "Case ID: AE-2025-001 \nPatient Information: 54-year-old female \nSuspected Drug: DrugX 50mg daily for hypertension \nConcomitant Medications: ", "extractionText": "Metformin", "afterText": " for diabetes, Aspirin 75mg daily \nAdverse Events: Severe headache, dizziness, nausea \nSeriousness Criteria: Hospitalization \nOutcome: Recovered after", "attributesHtml": "<div><strong>class:</strong> concomitant_medication</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">indication</span>: <span class=\"lx-attr-value\">diabetes</span>}</div>"}, {"index": 3, "class": "concomitant_medication", "text": "Aspirin 75mg daily", "color": "#C8E6C9", "startPos": 163, "endPos": 181, "beforeText": "025-001 \nPatient Information: 54-year-old female \nSuspected Drug: DrugX 50mg daily for hypertension \nConcomitant Medications: Metformin for diabetes, ", "extractionText": "Aspirin 75mg daily", "afterText": " \nAdverse Events: Severe headache, dizziness, nausea \nSeriousness Criteria: Hospitalization \nOutcome: Recovered after discontinuation of DrugX \nReport", "attributesHtml": "<div><strong>class:</strong> concomitant_medication</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">indication</span>: <span class=\"lx-attr-value\">cardiac protection</span>}</div>"}, {"index": 4, "class": "adverse_event", "text": "Severe headache", "color": "#D2E3FC", "startPos": 199, "endPos": 214, "beforeText": "r-old female \nSuspected Drug: DrugX 50mg daily for hypertension \nConcomitant Medications: Metformin for diabetes, Aspirin 75mg daily \nAdverse Events: ", "extractionText": "Severe headache", "afterText": ", dizziness, nausea \nSeriousness Criteria: Hospitalization \nOutcome: Recovered after discontinuation of DrugX \nReporter: Dr. John Smith, Cardiology De", "attributesHtml": "<div><strong>class:</strong> adverse_event</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">severity</span>: <span class=\"lx-attr-value\">Severe</span>}</div>"}, {"index": 5, "class": "adverse_event", "text": "dizziness", "color": "#D2E3FC", "startPos": 216, "endPos": 225, "beforeText": "pected Drug: DrugX 50mg daily for hypertension \nConcomitant Medications: Metformin for diabetes, Aspirin 75mg daily \nAdverse Events: Severe headache, ", "extractionText": "dizziness", "afterText": ", nausea \nSeriousness Criteria: Hospitalization \nOutcome: Recovered after discontinuation of DrugX \nReporter: Dr. John Smith, Cardiology Department, C", "attributesHtml": "<div><strong>class:</strong> adverse_event</div><div><strong>attributes:</strong> {}</div>"}, {"index": 6, "class": "adverse_event", "text": "nausea", "color": "#D2E3FC", "startPos": 227, "endPos": 233, "beforeText": ": DrugX 50mg daily for hypertension \nConcomitant Medications: Metformin for diabetes, Aspirin 75mg daily \nAdverse Events: Severe headache, dizziness, ", "extractionText": "nausea", "afterText": " \nSeriousness Criteria: Hospitalization \nOutcome: Recovered after discontinuation of DrugX \nReporter: Dr. John Smith, Cardiology Department, City Hosp", "attributesHtml": "<div><strong>class:</strong> adverse_event</div><div><strong>attributes:</strong> {}</div>"}, {"index": 7, "class": "seriousness", "text": "Hospitalization", "color": "#EADDFF", "startPos": 257, "endPos": 272, "beforeText": "nsion \nConcomitant Medications: Metformin for diabetes, Aspirin 75mg daily \nAdverse Events: Severe headache, dizziness, nausea \nSeriousness Criteria: ", "extractionText": "Hospitalization", "afterText": " \nOutcome: Recovered after discontinuation of DrugX \nReporter: Dr. John Smith, Cardiology Department, City Hospital \nDate Reported: 15-Jan-2025 \nNarra", "attributesHtml": "<div><strong>class:</strong> seriousness</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">criteria</span>: <span class=\"lx-attr-value\">Hospitalization</span>}</div>"}, {"index": 8, "class": "outcome", "text": "Recovered after discontinuation of DrugX", "color": "#FEF0C3", "startPos": 283, "endPos": 323, "beforeText": "ions: Metformin for diabetes, Aspirin 75mg daily \nAdverse Events: Severe headache, dizziness, nausea \nSeriousness Criteria: Hospitalization \nOutcome: ", "extractionText": "Recovered after discontinuation of DrugX", "afterText": " \nReporter: Dr. John Smith, Cardiology Department, City Hospital \nDate Reported: 15-Jan-2025 \nNarrative: \nThe patient reported experiencing severe hea", "attributesHtml": "<div><strong>class:</strong> outcome</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">status</span>: <span class=\"lx-attr-value\">Recovered</span>}</div>"}, {"index": 9, "class": "report_source", "text": "Dr. John Smith", "color": "#FFDDBE", "startPos": 335, "endPos": 349, "beforeText": "verse Events: Severe headache, dizziness, nausea \nSeriousness Criteria: Hospitalization \nOutcome: Recovered after discontinuation of DrugX \nReporter: ", "extractionText": "Dr. John Smith", "afterText": ", Cardiology Department, City Hospital \nDate Reported: 15-Jan-2025 \nNarrative: \nThe patient reported experiencing severe headache and dizziness within", "attributesHtml": "<div><strong>class:</strong> report_source</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">date_reported</span>: <span class=\"lx-attr-value\">15-Jan-2025</span>}</div>"}];
        let currentIndex = 0;
        let isPlaying = false;
        let animationInterval = null;
        let animationSpeed = 1.0;

        function updateDisplay() {
          const extraction = extractions[currentIndex];
          if (!extraction) return;

          document.getElementById('attributesContainer').innerHTML = extraction.attributesHtml;
          document.getElementById('entityInfo').textContent = (currentIndex + 1) + '/' + extractions.length;
          document.getElementById('posInfo').textContent = '[' + extraction.startPos + '-' + extraction.endPos + ']';
          document.getElementById('progressSlider').value = currentIndex;

          const playBtn = document.querySelector('.lx-control-btn');
          if (playBtn) playBtn.textContent = isPlaying ? '⏸ Pause' : '▶️ Play';

          const prevHighlight = document.querySelector('.lx-text-window .lx-current-highlight');
          if (prevHighlight) prevHighlight.classList.remove('lx-current-highlight');
          const currentSpan = document.querySelector('.lx-text-window span[data-idx="' + currentIndex + '"]');
          if (currentSpan) {
            currentSpan.classList.add('lx-current-highlight');
            currentSpan.scrollIntoView({block: 'center', behavior: 'smooth'});
          }
        }

        function nextExtraction() {
          currentIndex = (currentIndex + 1) % extractions.length;
          updateDisplay();
        }

        function prevExtraction() {
          currentIndex = (currentIndex - 1 + extractions.length) % extractions.length;
          updateDisplay();
        }

        function jumpToExtraction(index) {
          currentIndex = parseInt(index);
          updateDisplay();
        }

        function playPause() {
          if (isPlaying) {
            clearInterval(animationInterval);
            isPlaying = false;
          } else {
            animationInterval = setInterval(nextExtraction, animationSpeed * 1000);
            isPlaying = true;
          }
          updateDisplay();
        }

        window.playPause = playPause;
        window.nextExtraction = nextExtraction;
        window.prevExtraction = prevExtraction;
        window.jumpToExtraction = jumpToExtraction;

        updateDisplay();
      })();
    </script>